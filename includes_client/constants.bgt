// direction
dictionary word_east, word_west, word_north, word_south, word_up, word_down;

void install_word_hash()
{
word_west.set("왼", 0);
word_west.set("왼쪽", 0);
word_west.set("서", 0);
word_west.set("서쪽", 0);
word_west.set("좌", 0);
word_east.set("오", 0);
word_east.set("오른", 0);
word_east.set("오른쪽", 0);
word_east.set("동", 0);
word_east.set("동쪽", 0);
word_east.set("우", 0);
word_south.set("뒤", 0);
word_south.set("뒤쪽", 0);
word_south.set("남", 0);
word_south.set("남쪽", 0);
word_south.set("후", 0);
word_north.set("앞", 0);
word_north.set("앞쪽", 0);
word_north.set("북", 0);
word_north.set("북쪽", 0);
word_north.set("전", 0);
word_down.set("밑", 0);
word_down.set("밑쪽", 0);
word_down.set("아", 0);
word_down.set("아래", 0);
word_down.set("아래쪽", 0);
word_down.set("하", 0);
word_up.set("위", 0);
word_up.set("위쪽", 0);
word_up.set("상", 0);
}

// misc
const int Left = -1;
const int Right = 1;
const int Backward = 0;
const int Forward = 2;
const int Down = -2;
const int Up = 3;

double[] sine_theta = {0, 0.017452406437283, 0.034899496702501, 0.052335956242943, 0.069756473744125, 0.087155742747658, 0.104528463267653, 0.121869343405147, 0.139173100960065, 0.156434465040231, 0.17364817766693, 0.190808995376545, 0.207911690817759, 0.224951054343865, 0.241921895599668, 0.258819045102521, 0.275637355816999, 0.292371704722737, 0.309016994374947, 0.325568154457157, 0.342020143325669, 0.3583679495453, 0.374606593415912, 0.390731128489274, 0.4067366430758, 0.422618261740699, 0.438371146789077, 0.453990499739547, 0.469471562785891, 0.484809620246337, 0.5, 0.515038074910054, 0.529919264233205, 0.544639035015027, 0.559192903470747, 0.573576436351046, 0.587785252292473, 0.601815023152048, 0.615661475325658, 0.629320391049837, 0.642787609686539, 0.656059028990507, 0.669130606358858, 0.681998360062498, 0.694658370458997, 0.707106781186547, 0.719339800338651, 0.73135370161917, 0.743144825477394, 0.754709580222772, 0.766044443118978, 0.777145961456971, 0.788010753606722, 0.798635510047293, 0.809016994374947, 0.819152044288992, 0.829037572555042, 0.838670567945424, 0.848048096156426, 0.857167300702112, 0.866025403784439, 0.874619707139396, 0.882947592858927, 0.891006524188368, 0.898794046299167, 0.90630778703665, 0.913545457642601, 0.92050485345244, 0.927183854566787, 0.933580426497202, 0.939692620785908, 0.945518575599317, 0.951056516295154, 0.956304755963035, 0.961261695938319, 0.965925826289068, 0.970295726275996, 0.974370064785235, 0.978147600733806, 0.981627183447664, 0.984807753012208, 0.987688340595138, 0.99026806874157, 0.992546151641322, 0.994521895368273, 0.996194698091746, 0.997564050259824, 0.998629534754574, 0.999390827019096, 0.999847695156391, 1, 0.999847695156391, 0.999390827019096, 0.998629534754574, 0.997564050259824, 0.996194698091746, 0.994521895368273, 0.992546151641322, 0.99026806874157, 0.987688340595138, 0.984807753012208, 0.981627183447664, 0.978147600733806, 0.974370064785235, 0.970295726275996, 0.965925826289068, 0.961261695938319, 0.956304755963036, 0.951056516295154, 0.945518575599317, 0.939692620785908, 0.933580426497202, 0.927183854566787, 0.92050485345244, 0.913545457642601, 0.90630778703665, 0.898794046299167, 0.891006524188368, 0.882947592858927, 0.874619707139396, 0.866025403784439, 0.857167300702112, 0.848048096156426, 0.838670567945424, 0.829037572555042, 0.819152044288992, 0.809016994374947, 0.798635510047293, 0.788010753606722, 0.777145961456971, 0.766044443118978, 0.754709580222772, 0.743144825477394, 0.731353701619171, 0.719339800338651, 0.707106781186548, 0.694658370458997, 0.681998360062499, 0.669130606358858, 0.656059028990507, 0.642787609686539, 0.629320391049838, 0.615661475325658, 0.601815023152048, 0.587785252292473, 0.573576436351046, 0.559192903470747, 0.544639035015027, 0.529919264233205, 0.515038074910054, 0.5, 0.484809620246337, 0.469471562785891, 0.453990499739547, 0.438371146789077, 0.4226182617407, 0.4067366430758, 0.390731128489274, 0.374606593415912, 0.3583679495453, 0.342020143325669, 0.325568154457157, 0.309016994374948, 0.292371704722737, 0.275637355817, 0.258819045102521, 0.241921895599668, 0.224951054343865, 0.207911690817759, 0.190808995376545, 0.17364817766693, 0.156434465040231, 0.139173100960066, 0.121869343405148, 0.104528463267654, 0.087155742747658, 0.069756473744125, 0.052335956242943, 0.0348994967025, 0.017452406437283, 0, -0.017452406437283, -0.0348994967025, -0.052335956242943, -0.069756473744124, -0.087155742747657, -0.104528463267653, -0.121869343405148, -0.139173100960066, -0.156434465040231, -0.17364817766693, -0.190808995376545, -0.207911690817759, -0.224951054343865, -0.241921895599668, -0.25881904510252, -0.275637355816999, -0.292371704722736, -0.309016994374948, -0.325568154457157, -0.342020143325669, -0.3583679495453, -0.374606593415912, -0.390731128489274, -0.4067366430758, -0.422618261740699, -0.438371146789077, -0.453990499739546, -0.469471562785891, -0.484809620246337, -0.5, -0.515038074910054, -0.529919264233205, -0.544639035015027, -0.559192903470747, -0.573576436351046, -0.587785252292473, -0.601815023152048, -0.615661475325658, -0.629320391049838, -0.642787609686539, -0.656059028990507, -0.669130606358858, -0.681998360062498, -0.694658370458997, -0.707106781186547, -0.719339800338651, -0.73135370161917, -0.743144825477394, -0.754709580222772, -0.766044443118978, -0.777145961456971, -0.788010753606722, -0.798635510047293, -0.809016994374947, -0.819152044288992, -0.829037572555041, -0.838670567945424, -0.848048096156426, -0.857167300702112, -0.866025403784438, -0.874619707139396, -0.882947592858927, -0.891006524188368, -0.898794046299167, -0.90630778703665, -0.913545457642601, -0.92050485345244, -0.927183854566787, -0.933580426497202, -0.939692620785908, -0.945518575599317, -0.951056516295154, -0.956304755963035, -0.961261695938319, -0.965925826289068, -0.970295726275996, -0.974370064785235, -0.978147600733806, -0.981627183447664, -0.984807753012208, -0.987688340595138, -0.99026806874157, -0.992546151641322, -0.994521895368273, -0.996194698091746, -0.997564050259824, -0.998629534754574, -0.999390827019096, -0.999847695156391, -1, -0.999847695156391, -0.999390827019096, -0.998629534754574, -0.997564050259824, -0.996194698091746, -0.994521895368273, -0.992546151641322, -0.99026806874157, -0.987688340595138, -0.984807753012208, -0.981627183447664, -0.978147600733806, -0.974370064785235, -0.970295726275997, -0.965925826289068, -0.961261695938319, -0.956304755963035, -0.951056516295154, -0.945518575599317, -0.939692620785909, -0.933580426497202, -0.927183854566787, -0.92050485345244, -0.913545457642601, -0.90630778703665, -0.898794046299167, -0.891006524188368, -0.882947592858927, -0.874619707139396, -0.866025403784439, -0.857167300702112, -0.848048096156426, -0.838670567945424, -0.829037572555042, -0.819152044288992, -0.809016994374948, -0.798635510047293, -0.788010753606722, -0.777145961456971, -0.766044443118978, -0.754709580222772, -0.743144825477395, -0.731353701619171, -0.719339800338652, -0.707106781186548, -0.694658370458998, -0.681998360062498, -0.669130606358858, -0.656059028990507, -0.64278760968654, -0.629320391049838, -0.615661475325659, -0.601815023152048, -0.587785252292473, -0.573576436351046, -0.559192903470747, -0.544639035015027, -0.529919264233206, -0.515038074910054, -0.5, -0.484809620246337, -0.469471562785891, -0.453990499739547, -0.438371146789077, -0.4226182617407, -0.4067366430758, -0.390731128489275, -0.374606593415912, -0.358367949545301, -0.342020143325669, -0.325568154457158, -0.309016994374948, -0.292371704722736, -0.275637355817, -0.258819045102521, -0.241921895599668, -0.224951054343865, -0.20791169081776, -0.190808995376545, -0.173648177666931, -0.156434465040231, -0.139173100960066, -0.121869343405148, -0.104528463267653, -0.087155742747658, -0.069756473744124, -0.052335956242944, -0.0348994967025, -0.017452406437284, 0};

double[] cosine_theta = {1, 0.999847695156391, 0.999390827019096, 0.998629534754574, 0.997564050259824, 0.996194698091746, 0.994521895368273, 0.992546151641322, 0.99026806874157, 0.987688340595138, 0.984807753012208, 0.981627183447664, 0.978147600733806, 0.974370064785235, 0.970295726275996, 0.965925826289068, 0.961261695938319, 0.956304755963035, 0.951056516295154, 0.945518575599317, 0.939692620785908, 0.933580426497202, 0.927183854566787, 0.92050485345244, 0.913545457642601, 0.90630778703665, 0.898794046299167, 0.891006524188368, 0.882947592858927, 0.874619707139396, 0.866025403784439, 0.857167300702112, 0.848048096156426, 0.838670567945424, 0.829037572555042, 0.819152044288992, 0.809016994374947, 0.798635510047293, 0.788010753606722, 0.777145961456971, 0.766044443118978, 0.754709580222772, 0.743144825477394, 0.731353701619171, 0.719339800338651, 0.707106781186548, 0.694658370458997, 0.681998360062498, 0.669130606358858, 0.656059028990507, 0.642787609686539, 0.629320391049838, 0.615661475325658, 0.601815023152048, 0.587785252292473, 0.573576436351046, 0.559192903470747, 0.544639035015027, 0.529919264233205, 0.515038074910054, 0.5, 0.484809620246337, 0.469471562785891, 0.453990499739547, 0.438371146789077, 0.422618261740699, 0.4067366430758, 0.390731128489274, 0.374606593415912, 0.3583679495453, 0.342020143325669, 0.325568154457157, 0.309016994374947, 0.292371704722737, 0.275637355816999, 0.258819045102521, 0.241921895599668, 0.224951054343865, 0.207911690817759, 0.190808995376545, 0.17364817766693, 0.156434465040231, 0.139173100960066, 0.121869343405147, 0.104528463267653, 0.087155742747658, 0.069756473744125, 0.052335956242944, 0.034899496702501, 0.017452406437283, 0, -0.017452406437283, -0.0348994967025, -0.052335956242943, -0.069756473744125, -0.087155742747658, -0.104528463267653, -0.121869343405147, -0.139173100960065, -0.156434465040231, -0.17364817766693, -0.190808995376545, -0.207911690817759, -0.224951054343865, -0.241921895599668, -0.258819045102521, -0.275637355816999, -0.292371704722737, -0.309016994374947, -0.325568154457156, -0.342020143325669, -0.3583679495453, -0.374606593415912, -0.390731128489274, -0.4067366430758, -0.422618261740699, -0.438371146789078, -0.453990499739547, -0.469471562785891, -0.484809620246337, -0.5, -0.515038074910054, -0.529919264233205, -0.544639035015027, -0.559192903470747, -0.573576436351046, -0.587785252292473, -0.601815023152048, -0.615661475325658, -0.629320391049837, -0.642787609686539, -0.656059028990508, -0.669130606358858, -0.681998360062498, -0.694658370458997, -0.707106781186547, -0.719339800338651, -0.73135370161917, -0.743144825477394, -0.754709580222772, -0.766044443118978, -0.777145961456971, -0.788010753606722, -0.798635510047293, -0.809016994374947, -0.819152044288992, -0.829037572555042, -0.838670567945424, -0.848048096156426, -0.857167300702112, -0.866025403784439, -0.874619707139396, -0.882947592858927, -0.891006524188368, -0.898794046299167, -0.90630778703665, -0.913545457642601, -0.92050485345244, -0.927183854566787, -0.933580426497202, -0.939692620785908, -0.945518575599317, -0.951056516295154, -0.956304755963035, -0.961261695938319, -0.965925826289068, -0.970295726275996, -0.974370064785235, -0.978147600733806, -0.981627183447664, -0.984807753012208, -0.987688340595138, -0.99026806874157, -0.992546151641322, -0.994521895368273, -0.996194698091746, -0.997564050259824, -0.998629534754574, -0.999390827019096, -0.999847695156391, -1, -0.999847695156391, -0.999390827019096, -0.998629534754574, -0.997564050259824, -0.996194698091746, -0.994521895368273, -0.992546151641322, -0.99026806874157, -0.987688340595138, -0.984807753012208, -0.981627183447664, -0.978147600733806, -0.974370064785235, -0.970295726275996, -0.965925826289068, -0.961261695938319, -0.956304755963036, -0.951056516295154, -0.945518575599317, -0.939692620785908, -0.933580426497202, -0.927183854566787, -0.92050485345244, -0.913545457642601, -0.90630778703665, -0.898794046299167, -0.891006524188368, -0.882947592858927, -0.874619707139396, -0.866025403784439, -0.857167300702112, -0.848048096156426, -0.838670567945424, -0.829037572555042, -0.819152044288992, -0.809016994374948, -0.798635510047293, -0.788010753606722, -0.777145961456971, -0.766044443118978, -0.754709580222772, -0.743144825477394, -0.731353701619171, -0.719339800338651, -0.707106781186548, -0.694658370458998, -0.681998360062499, -0.669130606358858, -0.656059028990508, -0.642787609686539, -0.629320391049837, -0.615661475325658, -0.601815023152048, -0.587785252292473, -0.573576436351046, -0.559192903470747, -0.544639035015027, -0.529919264233205, -0.515038074910054, -0.5, -0.484809620246337, -0.469471562785891, -0.453990499739547, -0.438371146789078, -0.4226182617407, -0.4067366430758, -0.390731128489274, -0.374606593415912, -0.358367949545301, -0.342020143325669, -0.325568154457157, -0.309016994374948, -0.292371704722737, -0.275637355816999, -0.258819045102521, -0.241921895599668, -0.224951054343865, -0.20791169081776, -0.190808995376545, -0.17364817766693, -0.156434465040231, -0.139173100960065, -0.121869343405147, -0.104528463267653, -0.087155742747658, -0.069756473744125, -0.052335956242944, -0.034899496702501, -0.017452406437283, -0, 0.017452406437283, 0.034899496702501, 0.052335956242943, 0.069756473744125, 0.087155742747657, 0.104528463267653, 0.121869343405148, 0.139173100960065, 0.156434465040231, 0.17364817766693, 0.190808995376544, 0.207911690817759, 0.224951054343865, 0.241921895599667, 0.258819045102521, 0.275637355816999, 0.292371704722737, 0.309016994374947, 0.325568154457156, 0.342020143325668, 0.3583679495453, 0.374606593415912, 0.390731128489273, 0.406736643075801, 0.4226182617407, 0.438371146789077, 0.453990499739547, 0.46947156278589, 0.484809620246337, 0.5, 0.515038074910054, 0.529919264233205, 0.544639035015027, 0.559192903470746, 0.573576436351046, 0.587785252292473, 0.601815023152048, 0.615661475325659, 0.629320391049838, 0.642787609686539, 0.656059028990507, 0.669130606358858, 0.681998360062498, 0.694658370458997, 0.707106781186547, 0.719339800338651, 0.731353701619171, 0.743144825477394, 0.754709580222772, 0.766044443118978, 0.777145961456971, 0.788010753606722, 0.798635510047293, 0.809016994374947, 0.819152044288992, 0.829037572555041, 0.838670567945424, 0.848048096156425, 0.857167300702112, 0.866025403784438, 0.874619707139396, 0.882947592858927, 0.891006524188368, 0.898794046299167, 0.90630778703665, 0.913545457642601, 0.92050485345244, 0.927183854566787, 0.933580426497202, 0.939692620785908, 0.945518575599317, 0.951056516295154, 0.956304755963036, 0.961261695938319, 0.965925826289068, 0.970295726275996, 0.974370064785235, 0.978147600733806, 0.981627183447664, 0.984807753012208, 0.987688340595138, 0.99026806874157, 0.992546151641322, 0.994521895368273, 0.996194698091746, 0.997564050259824, 0.998629534754574, 0.999390827019096, 0.999847695156391, 1};

double[] calculate_theta = {0, 0.017453292519943, 0.034906585039886, 0.052359877559829, 0.069813170079773, 0.087266462599716, 0.10471975511966, 0.122173047639603, 0.139626340159546, 0.15707963267949, 0.174532925199433, 0.191986217719376, 0.20943951023932, 0.226892802759263, 0.244346095279206, 0.261799387799149, 0.279252680319093, 0.296705972839036, 0.314159265358979, 0.331612557878923, 0.349065850398866, 0.366519142918809, 0.383972435438752, 0.401425727958696, 0.418879020478639, 0.436332312998582, 0.453785605518526, 0.471238898038469, 0.488692190558412, 0.506145483078356, 0.523598775598299, 0.541052068118242, 0.558505360638185, 0.575958653158129, 0.593411945678072, 0.610865238198015, 0.628318530717959, 0.645771823237902, 0.663225115757845, 0.680678408277788, 0.698131700797732, 0.715584993317675, 0.733038285837618, 0.750491578357562, 0.767944870877505, 0.785398163397448, 0.802851455917391, 0.820304748437335, 0.837758040957278, 0.855211333477221, 0.872664625997165, 0.890117918517108, 0.907571211037051, 0.925024503556995, 0.942477796076938, 0.959931088596881, 0.977384381116825, 0.994837673636768, 1.01229096615671, 1.02974425867665, 1.0471975511966, 1.06465084371654, 1.08210413623648, 1.09955742875643, 1.11701072127637, 1.13446401379631, 1.15191730631626, 1.1693705988362, 1.18682389135614, 1.20427718387609, 1.22173047639603, 1.23918376891597, 1.25663706143592, 1.27409035395586, 1.2915436464758, 1.30899693899575, 1.32645023151569, 1.34390352403563, 1.36135681655558, 1.37881010907552, 1.39626340159546, 1.41371669411541, 1.43116998663535, 1.44862327915529, 1.46607657167524, 1.48352986419518, 1.50098315671512, 1.51843644923507, 1.53588974175501, 1.55334303427495, 1.5707963267949, 1.58824961931484, 1.60570291183478, 1.62315620435473, 1.64060949687467, 1.65806278939461, 1.67551608191456, 1.6929693744345, 1.71042266695444, 1.72787595947439, 1.74532925199433, 1.76278254451427, 1.78023583703422, 1.79768912955416, 1.8151424220741, 1.83259571459405, 1.85004900711399, 1.86750229963393, 1.88495559215388, 1.90240888467382, 1.91986217719376, 1.93731546971371, 1.95476876223365, 1.97222205475359, 1.98967534727354, 2.00712863979348, 2.02458193231342, 2.04203522483337, 2.05948851735331, 2.07694180987325, 2.0943951023932, 2.11184839491314, 2.12930168743308, 2.14675497995303, 2.16420827247297, 2.18166156499291, 2.19911485751286, 2.2165681500328, 2.23402144255274, 2.25147473507268, 2.26892802759263, 2.28638132011257, 2.30383461263252, 2.32128790515246, 2.3387411976724, 2.35619449019234, 2.37364778271229, 2.39110107523223, 2.40855436775217, 2.42600766027212, 2.44346095279206, 2.460914245312, 2.47836753783195, 2.49582083035189, 2.51327412287183, 2.53072741539178, 2.54818070791172, 2.56563400043166, 2.58308729295161, 2.60054058547155, 2.61799387799149, 2.63544717051144, 2.65290046303138, 2.67035375555132, 2.68780704807127, 2.70526034059121, 2.72271363311115, 2.7401669256311, 2.75762021815104, 2.77507351067098, 2.79252680319093, 2.80998009571087, 2.82743338823081, 2.84488668075076, 2.8623399732707, 2.87979326579064, 2.89724655831059, 2.91469985083053, 2.93215314335047, 2.94960643587042, 2.96705972839036, 2.9845130209103, 3.00196631343025, 3.01941960595019, 3.03687289847013, 3.05432619099008, 3.07177948351002, 3.08923277602996, 3.10668606854991, 3.12413936106985, 3.14159265358979, 3.15904594610974, 3.17649923862968, 3.19395253114962, 3.21140582366957, 3.22885911618951, 3.24631240870945, 3.2637657012294, 3.28121899374934, 3.29867228626928, 3.31612557878923, 3.33357887130917, 3.35103216382911, 3.36848545634906, 3.385938748869, 3.40339204138894, 3.42084533390889, 3.43829862642883, 3.45575191894877, 3.47320521146872, 3.49065850398866, 3.5081117965086, 3.52556508902855, 3.54301838154849, 3.56047167406843, 3.57792496658838, 3.59537825910832, 3.61283155162826, 3.63028484414821, 3.64773813666815, 3.66519142918809, 3.68264472170804, 3.70009801422798, 3.71755130674792, 3.73500459926787, 3.75245789178781, 3.76991118430775, 3.78736447682769, 3.80481776934764, 3.82227106186758, 3.83972435438753, 3.85717764690747, 3.87463093942741, 3.89208423194735, 3.9095375244673, 3.92699081698724, 3.94444410950718, 3.96189740202713, 3.97935069454707, 3.99680398706701, 4.01425727958696, 4.0317105721069, 4.04916386462684, 4.06661715714679, 4.08407044966673, 4.10152374218667, 4.11897703470662, 4.13643032722656, 4.1538836197465, 4.17133691226645, 4.18879020478639, 4.20624349730633, 4.22369678982628, 4.24115008234622, 4.25860337486616, 4.27605666738611, 4.29350995990605, 4.31096325242599, 4.32841654494594, 4.34586983746588, 4.36332312998582, 4.38077642250577, 4.39822971502571, 4.41568300754565, 4.4331363000656, 4.45058959258554, 4.46804288510548, 4.48549617762543, 4.50294947014537, 4.52040276266531, 4.53785605518526, 4.5553093477052, 4.57276264022514, 4.59021593274509, 4.60766922526503, 4.62512251778497, 4.64257581030492, 4.66002910282486, 4.6774823953448, 4.69493568786475, 4.71238898038469, 4.72984227290463, 4.74729556542458, 4.76474885794452, 4.78220215046446, 4.79965544298441, 4.81710873550435, 4.83456202802429, 4.85201532054424, 4.86946861306418, 4.88692190558412, 4.90437519810407, 4.92182849062401, 4.93928178314395, 4.9567350756639, 4.97418836818384, 4.99164166070378, 5.00909495322373, 5.02654824574367, 5.04400153826361, 5.06145483078356, 5.0789081233035, 5.09636141582344, 5.11381470834339, 5.13126800086333, 5.14872129338327, 5.16617458590322, 5.18362787842316, 5.2010811709431, 5.21853446346304, 5.23598775598299, 5.25344104850293, 5.27089434102288, 5.28834763354282, 5.30580092606276, 5.32325421858271, 5.34070751110265, 5.35816080362259, 5.37561409614254, 5.39306738866248, 5.41052068118242, 5.42797397370236, 5.44542726622231, 5.46288055874225, 5.48033385126219, 5.49778714378214, 5.51524043630208, 5.53269372882203, 5.55014702134197, 5.56760031386191, 5.58505360638185, 5.6025068989018, 5.61996019142174, 5.63741348394168, 5.65486677646163, 5.67232006898157, 5.68977336150151, 5.70722665402146, 5.7246799465414, 5.74213323906134, 5.75958653158129, 5.77703982410123, 5.79449311662117, 5.81194640914112, 5.82939970166106, 5.846852994181, 5.86430628670095, 5.88175957922089, 5.89921287174083, 5.91666616426078, 5.93411945678072, 5.95157274930066, 5.96902604182061, 5.98647933434055, 6.00393262686049, 6.02138591938044, 6.03883921190038, 6.05629250442032, 6.07374579694027, 6.09119908946021, 6.10865238198015, 6.1261056745001, 6.14355896702004, 6.16101225953998, 6.17846555205993, 6.19591884457987, 6.21337213709981, 6.23082542961976, 6.2482787221397, 6.26573201465964};
